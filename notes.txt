1. wipe up threads.
    tinker;
    $threads = factory(App\Thread::class, 50)->create();

2. wipe up replies for threads.
    tinker;
    $threads->each(function($thread){
        factory(App\Reply::class,10)->create([
            'thread_id' => $thread->id,
        ]);
    });

3. setup phpunit config file
./phpunit.xml
<php>
    :
    <env name="DB_CONNECTION" value="sqlite"/>
    <env name="DB_DATABASE" value=":memory:"/>
    :
</php>

4. add _ide_helper.php raw file

5. Test Levels Conceptions(in Laravel specific)
    * <Feature Test> from outside in ( High level test )
        Browser point of view / User point of view
    * <Unit Test / Integration Test Level> ( Low level test )

6. Obj has certain obj(s) -- $this->assertInstanceOf(Collection/Obj,relations);
    public function a_thread_has_replies()
    {
        $thread = factory('App\Thread')->create();
        $this->assertInstanceOf(Collection::class, $thread->replies);
    }

7. laravel ignore exception when doing test.
    enable: tweak render@app\Exceptions\Handler.php
    if(app()->environment() === 'testing') throw $exception;
    // throw exception directly when working under testing env rather render them.

8. testing expected exception
    /** @test **/
    public function unauthenticated_users_may_not_add_replies()
    {
        $this->expectException('Illuminate\Auth\AuthenticationException');
        $this->post('/threads/1/replies', []);
    }
9. factory stuffs
        factory('App\User')->raw();     // whip up an array of User in memory
        factory('App\User')->make();    // whip up an instance of User in memory
        factory('App\User')->create();  // whip up an instance of User and persist in database

10. TestCase basis
    'Feature Test':     auth/user/process/behavior/validation (controller related test);
    'Unit Test':        eloquent/model related test(relationships, methods, properties)

11. Exception withHandling/withoutHandling solution and remove No.7 treatment
    https://gist.github.com/adamwathan/125847c7e3f16b88fa33a9f8b42333da

12. To simulate a post appropriately
        // the issue is we used to do create rather than make which is not correct.
        // to simulate a post, we should prepare the data, use `make` is more appropriate.
        // $thread = create('App\Thread');
        // but the thing is if we 'make' the thread, we will no longer grab $thread->id,
        // cuz it is not been persisted. to solve that we need simulate the post first
        // and grab the id from the header in the response of the post.

        $thread = make('App\Thread');
        $response = $this->post('/threads', $thread->toArray());
        $path = $response->headers->get('Location');
        $this->get($path)
            ->assertSee($thread->title)
            ->assertSee($thread->body);
